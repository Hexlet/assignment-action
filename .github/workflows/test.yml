name: test

on:
  - push
  - pull_request

jobs:
  tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: make setup
      - run: make test
      - run: make lint

  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - run: make setup
      - run: make run-test-api-server && sleep 5
      - uses: ./
        env:
          ACTION_API_HOST: http://localhost:3000
        with:
          hexlet_token: 'some-token'
          verbose: true
